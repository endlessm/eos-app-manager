<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"
"http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">

<!-- Copyright 2014 Endless Mobile, Inc. -->

<node>
  <!--
      com.endlessm.AppManager:
      @short_description: The EOS Application Manager service

      This is the interface you use to talk with the EOS Application Manager.
  -->
  <interface name="com.endlessm.AppManager">

    <!--
      AvailableUpdates as read-only:

      Specifies the list of updates currently available by app_id
    -->
    <property name="AvailableUpdates" type="as" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="true" />
    </property>

    <!--
      AvailableApplicationsChanged (as available_applications):

      A signal to which other processes can subscribe, indicating that the
      list of available applications has been updated. The passed-in array
      of strings is the new value returned by ListAvailable()
    -->
    <signal name="AvailableApplicationsChanged">
      <arg name="available" type="a(sssx)" direction="out" />
      <arg name="updatable" type="a(sssx)" direction="out" />
    </signal>

    <!--
      GetUserCapabilities:

      Retrieves a list of capabilities for the UID that called
      this method.

      The returned array of key, value pairs has the following
      keys and value types:

       * "CanInstall", bool
       * "CanUpdate", bool
       * "CanUninstall", bool
    -->
    <method name="GetUserCapabilities">
      <annotation name="org.freedesktop.DBus.GLib.Async" value="" />
      <arg name="capabilities" type="a{sv}" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value="error" />
      </arg>
    </method>

    <!--
      Refresh:

      Refreshes the package database.
    -->
    <method name="Refresh" >
      <annotation name="org.freedesktop.DBus.GLib.Async" value="" />
      <arg name="success" type="b" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value="error" />
      </arg>
    </method>

    <!--
      Install:

      Installs a package.

      Expects:

       * Application ID for the app that is to be installed
       * Flag whether we are fine with using deltas

      Returns:
       * Transaction DBus path if successful or an error
    -->
    <method name="Install" >
      <annotation name="org.freedesktop.DBus.GLib.Async" value="" />
      <arg name="appid" type="s" direction="in" />
      <arg name="transaction" type="o" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value="error" />
      </arg>
    </method>

    <!--
      Update:

      Updates a package.

      Expects:

       * Application ID for the app that is to be updated
       * Flag whether we are fine with using deltas for the process

      Returns:
       * Transaction DBus path if successful or an error
    -->
    <method name="Update" >
      <annotation name="org.freedesktop.DBus.GLib.Async" value="" />
      <arg name="appid" type="s" direction="in" />
      <arg name="allow_deltas" type="b" direction="in" />
      <arg name="transaction" type="o" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value="error" />
      </arg>
    </method>

    <!--
      Uninstall:

      Uninstalls a package.
    -->
    <method name="Uninstall" >
      <annotation name="org.freedesktop.DBus.GLib.Async" value="" />
      <arg name="appid" type="s" direction="in" />
      <arg name="transaction" type="b" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value="error" />
      </arg>
    </method>

    <!--
      ListAvailable:

      Returns a list of all applications available for installation
      and for updates.
    -->
    <method name="ListAvailable" >
      <annotation name="org.freedesktop.DBus.GLib.Async" value="" />
      <arg name="filters" type="a{sv}" direction="in" />
      <arg name="installable" type="a(sssx)" direction="out" />
      <arg name="updatable" type="a(sssx)" direction="out" />
    </method>

    <!--
      ListInstalled:

      Returns two arrays of (id, name, version) tuples:

        * a list of installed applications
        * a list of installed applications that can be removed
    -->
    <method name="ListInstalled" >
      <annotation name="org.freedesktop.DBus.GLib.Async" value="" />
      <arg name="installed" type="a(sssx)" direction="out" />
      <arg name="removable" type="a(sssx)" direction="out" />
    </method>

    <!--
      Quit:

      Suggest to the daemon to quit.
    -->
    <method name="Quit" />

    <!--
      Cancel:

      Suggest to the daemon to cancel the current transaction.
    -->
    <method name="Cancel" />

  </interface>
</node>
